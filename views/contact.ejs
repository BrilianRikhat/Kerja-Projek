<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <title>Home Page</title>
    <link rel="stylesheet" href="contact.css">
</head>
<body>

<nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-top">
 <a class="navbar-brand" href="/home">Brilian Rikhat</a>
 <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
    <span class="navbar-toggler-icon"></span>
 </button>
 <div class="collapse navbar-collapse" id="collapsibleNavbar">
  <ul class="navbar-nav">
    <li class="nav-item">
      <a class="nav-link" href="/home">Home</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/about">About Me</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/skills">Skills</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/portofolio">Portfolio</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/contact">Contact</a>
    </li>
    <li class="nav-item invisible-button">
      <a class="nav-link" href="/login">ADMIN</a>
    </li>
  </ul>
 </div>
</nav>

<div class="container">
  <h2>Contact Form</h2>
  <form>
     <div class="form-group">
       <label for="fname">Name:</label>
       <input type="text" class="form-control" id="fname" placeholder="Enter Your Name" name="fname">
     </div>
     <div class="form-group">
       <label for="email">Email:</label>
       <input type="email" class="form-control" id="email" placeholder="Enter Email" name="email">
     </div>
     <div class="form-group">
       <label for="message">Message:</label>
       <textarea class="form-control" rows="5" id="message" placeholder="Enter Your Message" name="message"></textarea>
     </div>
     <button type="button" class="btn btn-primary">Submit</button>
  </form>
 </div>

 <!-- <div class="container-feedback">
  <% //db.forEach(element => { %>
      <% //const {fname,lname,email,message,time}= element %>
       <div class="box">
           <span id="nama"><%= //fname %> <%= //lname %></span>
           <p class="email"><%= //email %></p>
           <p class="message"><%=// message %></p>
       </div>
  <% //}) %>
 </div>
 -->

 <script>



   let decrement = 3;
   const box = document.querySelectorAll(".container-feedback .box");
  const containerFeedback = document.querySelector(".container-feedback");
  const button = document.querySelector(".btn-primary");
  const fname = document.querySelector("#fname");
  // const lname = document.querySelector("#lname");
  const email = document.querySelector("#email");
  const message = document.querySelector("#message");
  button.addEventListener("click", () => {
   const fnameValue = fname.value;
  //  const lnameValue = lname.value;
   const emailValue = email.value;
   const messageValue = message.value;

   const result = {
    fname: fnameValue,
    // lname: lnameValue,
    email: emailValue,
    message: messageValue,
    time: getTime(),
   }

   if (!fnameValue || !emailValue || !messageValue) {
    alert("Harap isi semua kolom!");
  } else {
    button.disabled = true;
     fetch("http://localhost:3000/contact", {
      method: 'POST',
      headers: {
    'Content-Type': 'application/json'
  },
     body: JSON.stringify(result)
     })
     .then(res => res.json())
     .then(data => {
      alert("data berhasil masuk");
     });
    uiAlert();
    setTimeout(() => {
      clearInterval(uiAlert)
      location.reload()
      button.disabled = false;
    }, 4000)
  }
   
})


function uiAlert() {
   return setInterval(() => {
       boxAlert();
   },1000)
}

function boxAlert() {
   console.log(`tunggu ${decrement--}`)
}





// let sensor = ["titid","kontol","memek","biji","ajg"];
const massageSensor =  document.querySelectorAll(".message");
const containerForm = document.querySelector(".container form");

setTimeout(() => {
          containerForm.style.left = "0"
}, 500)

massageSensor.forEach(e => {
  const kt = kataKasar(e.innerHTML);
  e.innerHTML = kt;
})


function kataKasar(e) {
    let result;
    sensor.forEach(s => {
       if (e.indexOf(s) > -1) {
        result = "*".repeat(e.length);
       }
    })

    if (result == undefined) {
      return e
    } else {
      return result;
    }
}



window.addEventListener("scroll", (e) => {
     const topContainerfeedback = containerFeedback.getBoundingClientRect().top;
     if (topContainerfeedback < window.innerHeight ) {
        box.forEach( e => {
          e.classList.add("activeBox");
        })
     } else {
      box.forEach(e => {
        e.classList.remove("activeBox");
      })
     }
})





function getTime() {
        var waktuSekarangUTC = new Date();
        var zonaWaktuLokal = "Asia/Jakarta";
        var waktuSekarangLokal = waktuSekarangUTC.toLocaleString('en-ID', { timeZone: zonaWaktuLokal });
        var stringWaktuLokal = `${waktuSekarangLokal}`;
        return stringWaktuLokal;
      }





 </script>

